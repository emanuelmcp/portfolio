---
import { Image } from "astro:assets";

import aws from "../assets/stack/aws.png";
import java from "../assets/stack/java.png";
import nestjs from "../assets/stack/nestjs.png";
import postgre from "../assets/stack/postgre.png";
import redis from "../assets/stack/redis.png";
import docker from "../assets/stack/docker.png";
import spring from "../assets/stack/spring.png";
import typescript from "../assets/stack/typescript.png";
import angular from "../assets/stack/angular.png";
import leadership from "../assets/stack/leadership.png";
import talking from "../assets/stack/talking.png";
import think from "../assets/stack/think.png";
import emanuel from "../assets/about/emanuel.png";
import hired from "../assets/about/hired.png";

const skills = {
  languages: [
    { name: "Java", alt: "Logo de Java", img: java },
    { name: "TypeScript", alt: "Logo de TypeScript", img: typescript },
  ],
  frameworks: [
    { name: "Spring Boot", alt: "Logo de Spring Boot", img: spring },
    { name: "NestJS", alt: "Logo de NestJS", img: nestjs },
    { name: "Angular", alt: "Logo de Angular", img: angular },
  ],
  infrastructure: [
    { name: "Docker", alt: "Logo de Docker", img: docker },
    { name: "PostgreSQL", alt: "Logo de PostgreSQL", img: postgre },
    { name: "AWS", alt: "Logo de AWS", img: aws },
    { name: "Redis", alt: "Logo de Redis", img: redis },
  ],
  softSkills: [
    {
      name: "Liderazgo",
      alt: "Icono que representa el liderazgo",
      img: leadership,
    },
    {
      name: "Comunicación efectiva",
      alt: "Icono que representa la comunicación efectiva",
      img: talking,
    },
    {
      name: "Pensamiento crítico",
      alt: "Icono que representa el pensamiento crítico",
      img: think,
    },
  ],
};

const computeCategoriesInSpanish = (category: string) => {
  switch (category) {
    case "languages":
      return "LENGUAJES";
    case "frameworks":
      return "FRAMEWORKS";
    case "infrastructure":
      return "INFRAESTRUCTURA";
    case "softSkills":
      return "HABILIDADES BLANDAS";
    default:
      return category.toUpperCase();
  }
};
---

<section
  id="hero"
  class="min-h-screen flex items-center justify-center px-4 py-20 bg-black text-foreground font-mono"
>
  <div class="container mx-auto max-w-6xl space-y-8">
    <!-- ASCII Art Header -->
    <div class="hidden lg:block overflow-x-auto">
      <pre
        class="text-center text-foreground text-xs md:text-sm leading-tight">
{`
███████╗███╗   ███╗ █████╗ ███╗   ██╗██╗   ██╗███████╗██╗          ██████╗ █████╗ ██████╗ ██████╗ ███████╗██████╗  ██████╗ 
██╔════╝████╗ ████║██╔══██╗████╗  ██║██║   ██║██╔════╝██║         ██╔════╝██╔══██╗██╔══██╗██╔══██╗██╔════╝██╔══██╗██╔═══██╗
█████╗  ██╔████╔██║███████║██╔██╗ ██║██║   ██║█████╗  ██║         ██║     ███████║██████╔╝██████╔╝█████╗  ██████╔╝██║   ██║
██╔══╝  ██║╚██╔╝██║██╔══██║██║╚██╗██║██║   ██║██╔══╝  ██║         ██║     ██╔══██║██╔══██╗██╔══██╗██╔══╝  ██╔══██╗██║   ██║
███████╗██║ ╚═╝ ██║██║  ██║██║ ╚████║╚██████╔╝███████╗███████╗    ╚██████╗██║  ██║██║  ██║██║  ██║███████╗██║  ██║╚██████╔╝
╚══════╝╚═╝     ╚═╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝ ╚══════╝╚══════╝     ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝ ╚═════╝ 
`}
      </pre>
    </div>

    <!-- Typing Effect Title -->
    <div class="text-center space-y-4">
      <h1 class="hidden lg:block text-2xl md:text-4xl font-bold text-accent">
        &gt; <span
          id="typing"
          class="terminal-cursor border-r-2 border-foreground pr-1 text-accent"></span>
      </h1>
      <h1 class="lg:hidden text-2xl md:text-4xl font-bold text-accent">
        &gt; Desarrollador fullstack especializado en backend
      </h1>
      <p class="text-primary text-sm md:text-base max-w-2xl mx-auto">
        Construyendo sistemas robustos y escalables desde el backend.<br />
        Especializado en arquitecturas distribuidas, APIs y optimización de rendimiento.
      </p>
    </div>

    <!-- Terminal -->
    <div
      class="border border-primary rounded-xl shadow-lg shadow-green-800/30 bg-black/95 overflow-hidden min-h-[500px] relative"
    >
      <!-- Terminal Header -->
      <div
        class="ffolder-header flex items-center justify-between bg-primary/10 px-3 py-1 cursor-pointer select-none min-h-6 rounded"
      >
        <span class="font-semibold">CodELITE v2.1</span>
        <div class="flex gap-2">
          <span class="w-3 h-3 rounded-full bg-red-500"></span>
          <span class="w-3 h-3 rounded-full bg-yellow-400"></span>
          <span class="w-3 h-3 rounded-full bg-primary"></span>
        </div>
      </div>

      <!-- Terminal Body -->
      <div id="terminal-body" class="p-6 space-y-4 min-h-[400px] text-sm">
        <!-- Loading Screen -->
        <div id="loading-screen" class="space-y-4">
          <p>&gt; Accediendo a base de datos...</p>
          <p class="text-foreground">
            &gt; Descifrando archivos clasificados...
          </p>
          <p class="text-foreground">&gt; Cargando expediente...</p>
          <div class="mt-6">
            <div class="flex items-center gap-3">
              <div
                class="flex-1 h-2 bg-green-800/30 rounded-full overflow-hidden"
              >
                <div
                  id="progress-bar"
                  class="h-full bg-foreground transition-all duration-300 ease-out"
                  style="width:0%;"
                >
                </div>
              </div>
              <span id="progress-text" class="min-w-[3ch] text-right">0%</span>
            </div>
          </div>
        </div>
        <!-- Dossier Screen -->
        <div
          id="dossier"
          class="space-y-6 hidden p-4 bg-primary/10 rounded-lg border border-primary"
        >
          <!-- Carnet Header -->
          <div
            class="flex items-center justify-between border-b border-primary pb-2 mb-4"
          >
            <h2 class="text-accent font-bold text-lg">EXPEDIENTE DE AGENTE</h2>
            <span class="text-xs text-accent"
              >ID: DEV-2024-001 | NIVEL: SENIOR | ACTIVO</span
            >
          </div>

          <!-- Info y Foto -->
          <div class="grid md:grid-cols-[1fr_200px] gap-4 items-start">
            <!-- Información -->
            <div class="space-y-2">
              <div>
                <p class="text-accent text-xs font-semibold">
                  NOMBRE COMPLETO
                </p>
                <p class="text-primary text-sm">Emanuel Carrero</p>
              </div>
              <div>
                <p class="text-accent text-xs font-semibold">
                  ESPECIALIZACIÓN
                </p>
                <p class="text-primary text-sm">
                  Desarrollo Backend | Arquitectura de Sistemas
                </p>
              </div>
              <div>
                <p class="text-accent text-xs font-semibold">EXPERIENCIA</p>
                <p class="text-primary text-sm">+5 años</p>
              </div>

              <!-- Skills como tarjetas -->
              <div class="mt-4 space-y-3">
                {
                  Object.entries(skills).map(([category, items]) => (
                    <div>
                      <p class="text-accent text-xs font-semibold mb-1">
                        {computeCategoriesInSpanish(category)}
                      </p>
                      <ul class="flex flex-wrap gap-2">
                        {items.map((skill, index) => (
                          <li
                            class="flex items-center gap-1 text-primary px-2 py-1 rounded opacity-0"
                            style={`animation: fadeIn 0.5s ease forwards; animation-delay: ${index * 50}ms;`}
                          >
                            {skill.img && (
                              <Image
                                src={skill.img}
                                alt={skill.alt}
                                class="w-4 h-4 object-contain"
                              />
                            )}
                            <span class="text-xs">{skill.name}</span>
                          </li>
                        ))}
                      </ul>
                    </div>
                  ))
                }
              </div>
            </div>

            <!-- Foto del agente -->
            <div class="flex flex-col items-center gap-2">
              <div class="relative w-full group">
                <div class="relative w-full">
                  <div
                    class="absolute -inset-1 bg-gradient-to-tr from-primary/40 to-accent/40 blur opacity-60 group-hover:opacity-30 transition"
                  >
                  </div>

                  <Image
                    src={emanuel}
                    alt="Foto de Emanuel"
                    class="relative rounded-lg object-cover w-full h-auto transform transition duration-500 group-hover:scale-105"
                  />
                </div>
              </div>
              <p class="text-accent text-xs font-bold">AGENTE: BUGZILLA</p>
              <p class="text-foreground text-xs">Backend Specialist</p>
            </div>
          </div>

          <!-- Footer -->
          <div class="border-t border-primary pt-2 text-xs text-primary">
            &gt; Expediente cargado exitosamente. ACCESO AUTORIZADO ✓
          </div>
        </div>

        <!-- Terminal Prompt -->
        <div class="text-center mt-12 text-foreground text-sm">
          <p>&gt; Presiona cualquier tecla para continuar...</p>
        </div>
      </div>
    </div>
  </div>
</section>
<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.8);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* Terminal cursor blink */
  .terminal-cursor {
    animation: blink 1s step-end infinite;
  }

  @keyframes blink {
    50% {
      border-color: transparent;
    }
  }
</style>

<script is:inline>
  // Typing effect
  const typingEl = document.getElementById("typing");
  const fullText = "Desarrollador fullstack especializado en backend ";
  let i = 0;
  const typingInterval = setInterval(() => {
    if (i <= fullText.length) {
      typingEl.textContent = fullText.slice(0, i);
      i++;
    } else {
      clearInterval(typingInterval);
    }
  }, 50);

  // Progress bar
  const progressBar = document.getElementById("progress-bar");
  const progressText = document.getElementById("progress-text");
  const loadingScreen = document.getElementById("loading-screen");
  const dossier = document.getElementById("dossier");
  let progress = 0;

  const progressInterval = setInterval(() => {
    if (progress >= 100) {
      clearInterval(progressInterval);
      setTimeout(() => {
        loadingScreen.classList.add("hidden");
        dossier.classList.remove("hidden");

        // Animar los logos
        document.querySelectorAll("#skills-container > div").forEach((el) => {
          el.classList.remove("opacity-0");
        });
      }, 300);
    } else {
      progress += 2;
      progressBar.style.width = progress + "%";
      progressText.textContent = progress + "%";
    }
  }, 30);
</script>
