---
import { Image } from "astro:assets";

import aws from "../assets/stack/aws.png";
import java from "../assets/stack/java.png";
import nestjs from "../assets/stack/nestjs.png";
import postgre from "../assets/stack/postgre.png";
import redis from "../assets/stack/redis.png";
import docker from "../assets/stack/docker.png";
import spring from "../assets/stack/spring.png";
import typescript from "../assets/stack/typescript.png";
import angular from "../assets/stack/angular.png";
import emanuel from "../assets/about/emanuel.png";
import hired from "../assets/about/hired.png";

const skills = [
  { name: "Java", img: java },
  { name: "TypeScript", img: typescript },
  { name: "Spring Boot", img: spring },
  { name: "NestJS", img: nestjs },
  { name: "Docker", img: docker },
  { name: "PostgreSQL", img: postgre },
  { name: "AWS", img: aws },
  { name: "Redis", img: redis },
  { name: "Angular", img: angular },
];
---

<section
  id="hero"
  class="min-h-screen flex items-center justify-center px-4 py-20 bg-black text-foreground font-mono"
>
  <div class="container mx-auto max-w-6xl space-y-8">
    <!-- ASCII Art Header -->
    <div class="overflow-x-auto">
      <pre
        class="text-center text-foreground text-xs md:text-sm leading-tight">
{`
███████╗███╗   ███╗ █████╗ ███╗   ██╗██╗   ██╗███████╗██╗          ██████╗ █████╗ ██████╗ ██████╗ ███████╗██████╗  ██████╗ 
██╔════╝████╗ ████║██╔══██╗████╗  ██║██║   ██║██╔════╝██║         ██╔════╝██╔══██╗██╔══██╗██╔══██╗██╔════╝██╔══██╗██╔═══██╗
█████╗  ██╔████╔██║███████║██╔██╗ ██║██║   ██║█████╗  ██║         ██║     ███████║██████╔╝██████╔╝█████╗  ██████╔╝██║   ██║
██╔══╝  ██║╚██╔╝██║██╔══██║██║╚██╗██║██║   ██║██╔══╝  ██║         ██║     ██╔══██║██╔══██╗██╔══██╗██╔══╝  ██╔══██╗██║   ██║
███████╗██║ ╚═╝ ██║██║  ██║██║ ╚████║╚██████╔╝███████╗███████╗    ╚██████╗██║  ██║██║  ██║██║  ██║███████╗██║  ██║╚██████╔╝
╚══════╝╚═╝     ╚═╝╚═╝  ╚═╝╚═╝  ╚═══╝ ╚═════╝ ╚══════╝╚══════╝     ╚═════╝╚═╝  ╚═╝╚═╝  ╚═╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝ ╚═════╝ 
`}
      </pre>
    </div>

    <!-- Typing Effect Title -->
    <div class="text-center space-y-4">
      <h1 class="text-2xl md:text-4xl font-bold">
        &gt; <span
          id="typing"
          class="terminal-cursor border-r-2 border-foreground pr-1"></span>
      </h1>
      <p class="text-green-300 text-sm md:text-base max-w-2xl mx-auto">
        // Construyendo sistemas robustos y escalables desde el backend.<br />
        // Especializado en arquitecturas distribuidas, APIs y optimización de rendimiento.
      </p>
    </div>

    <!-- Terminal -->
    <div
      class="border border-primary rounded-xl shadow-lg shadow-green-800/30 bg-black/95 overflow-hidden min-h-[500px] relative"
    >
      <!-- Terminal Header -->
      <div
        class="flex items-center justify-between bg-green-800/20 px-3 py-2 border-b border-primary"
      >
        <span class="font-semibold">SISTEMA DE ARCHIVOS CLASIFICADOS v2.1</span>
        <div class="flex gap-2">
          <span class="w-3 h-3 rounded-full bg-red-500"></span>
          <span class="w-3 h-3 rounded-full bg-yellow-400"></span>
          <span class="w-3 h-3 rounded-full bg-green-500"></span>
        </div>
      </div>

      <!-- Terminal Body -->
      <div id="terminal-body" class="p-6 space-y-4 min-h-[400px] text-sm">
        <!-- Loading Screen -->
        <div id="loading-screen" class="space-y-4">
          <p>&gt; Accediendo a base de datos...</p>
          <p class="text-foreground">
            &gt; Descifrando archivos clasificados...
          </p>
          <p class="text-foreground">&gt; Cargando expediente...</p>
          <div class="mt-6">
            <div class="flex items-center gap-3">
              <div
                class="flex-1 h-2 bg-green-800/30 rounded-full overflow-hidden"
              >
                <div
                  id="progress-bar"
                  class="h-full bg-foreground transition-all duration-300 ease-out"
                  style="width:0%;"
                >
                </div>
              </div>
              <span id="progress-text" class="min-w-[3ch] text-right">0%</span>
            </div>
          </div>
        </div>

        <!-- Dossier Screen -->
        <div id="dossier" class="space-y-6 hidden">
          <!-- Dossier Header -->
          <div class="border-b border-primary pb-4">
            <div class="flex items-center gap-2 text-foreground mb-2">
              <span>█</span>
              <span class="text-lg font-bold">EXPEDIENTE CLASIFICADO</span>
              <span>█</span>
            </div>
            <p class="text-foreground text-xs">
              ID: DEV-2024-001 | NIVEL: SENIOR | ESTADO: ACTIVO
            </p>
          </div>

          <!-- Profile Section -->
          <div class="grid md:grid-cols-[1fr_320px] gap-6 items-center">
            <!-- Info -->
            <div class="space-y-4">
              <div>
                <p class="text-primary text-xs mb-1">&gt; NOMBRE COMPLETO:</p>
                <p class="text-primary">Tu Nombre Aquí</p>
              </div>
              <div>
                <p class="text-foreground text-xs mb-1">
                  &gt; ESPECIALIZACIÓN:
                </p>
                <p class="text-primary">
                  Desarrollo Backend | Arquitectura de Sistemas
                </p>
              </div>
              <div>
                <p class="text-foreground text-xs mb-1">
                  &gt; AÑOS DE EXPERIENCIA:
                </p>
                <p class="text-primary">5+ años</p>
              </div>
              <div>
                <p class="text-foreground text-xs mb-1">
                  &gt; CLEARANCE LEVEL:
                </p>
                <p class="text-foreground font-bold">SENIOR</p>
              </div>

              <!-- Skills Section -->
              <div class="border-t border-primary pt-4">
                <div class="flex items-center gap-2 text-foreground mb-4">
                  <span>▸</span>
                  <span class="font-bold">HABILIDADES TÉCNICAS</span>
                </div>
                <div
                  id="skills-container"
                  class="grid grid-cols-4 md:grid-cols-5 gap-4"
                >
                  {
                    skills.map((skill, index) => (
                      <div
                        class={`flex flex-col items-center opacity-0`}
                        style={`animation: fadeIn 0.5s ease forwards; animation-delay: ${index * 50}ms;`}
                      >
                        {skill.img && (
                          <Image
                            src={skill.img}
                            alt={skill.name}
                            class="w-12 h-12 object-contain"
                          />
                        )}
                        <span class="text-xs mt-1">{skill.name}</span>
                      </div>
                    ))
                  }
                </div>
              </div>
            </div>

            <!-- Photo -->
            <div class="flex flex-col items-center gap-3">
              <div class="relative w-full group">
                <div
                  class="absolute -inset-1 bg-foreground/30 blur opacity-40 group-hover:opacity-20 transition"
                >
                </div>
                <Image
                  src={emanuel}
                  alt="Foto de Emanuel"
                  class="relative shadow-2xl object-cover h-80 mx-auto transform transition duration-500 group-hover:rotate-2 group-hover:scale-105"
                  widths={[320, 480, 640, 768, 1024]}
                  sizes="(max-width: 1024px) 100vw, 320px"
                  loading="lazy"
                />
                <Image
                  src={hired}
                  alt="Sello de contratado"
                  class="absolute top-1/2 left-1/2 w-[130%] max-w-none opacity-0 transform -translate-x-1/2 -translate-y-1/2 rotate-[-25deg] transition duration-700 ease-out group-hover:opacity-100 group-hover:scale-105 group-hover:rotate-[-20deg]"
                  widths={[480, 640, 768, 1024]}
                  sizes="(max-width: 1024px) 80vw, 480px"
                />
              </div>
              <div class="text-center">
                <p class="font-bold">AGENTE: CODE_HACKER</p>
                <p class="text-foreground text-xs">Backend Specialist</p>
              </div>
            </div>
          </div>

          <!-- Footer -->
          <div class="border-t border-primary pt-4 text-xs text-foreground">
            <p>
              &gt; Expediente cargado exitosamente. Todos los sistemas
              operativos.
            </p>
            <p class="text-green-300 mt-1">&gt; ACCESO AUTORIZADO ✓</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Terminal Prompt -->
    <div class="text-center mt-12 text-foreground text-sm">
      <p>&gt; Presiona cualquier tecla para continuar...</p>
    </div>
  </div>
</section>

<style>
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: scale(0.8);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* Terminal cursor blink */
  .terminal-cursor {
    animation: blink 1s step-end infinite;
  }

  @keyframes blink {
    50% {
      border-color: transparent;
    }
  }
</style>

<script is:inline>
  // Typing effect
  const typingEl = document.getElementById("typing");
  const fullText = "Fullstack Developer // Heavy Backend";
  let i = 0;
  const typingInterval = setInterval(() => {
    if (i <= fullText.length) {
      typingEl.textContent = fullText.slice(0, i);
      i++;
    } else {
      clearInterval(typingInterval);
    }
  }, 50);

  // Progress bar
  const progressBar = document.getElementById("progress-bar");
  const progressText = document.getElementById("progress-text");
  const loadingScreen = document.getElementById("loading-screen");
  const dossier = document.getElementById("dossier");
  let progress = 0;

  const progressInterval = setInterval(() => {
    if (progress >= 100) {
      clearInterval(progressInterval);
      setTimeout(() => {
        loadingScreen.classList.add("hidden");
        dossier.classList.remove("hidden");

        // Animar los logos
        document.querySelectorAll("#skills-container > div").forEach((el) => {
          el.classList.remove("opacity-0");
        });
      }, 300);
    } else {
      progress += 2;
      progressBar.style.width = progress + "%";
      progressText.textContent = progress + "%";
    }
  }, 30);
</script>
